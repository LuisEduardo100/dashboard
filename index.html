<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Comercial | Aled Atacado</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./script.js">
    <link rel="stylesheet" href="./style.css">
    <script src="./script.js" defer></script>

</head>

<body>

    <header>
        <div class="header-content">
            <div class="header-title">
                <h1>ðŸ“Š Dashboard <small>Aled Atacado</small></h1>
            </div>

            <div class="filters" id="filtersMenu">
                <button class="filter-btn active" onclick="filtrar('geral')" id="btn-geral">Geral</button>
                <button class="filter-btn" onclick="filtrar('mes')" id="btn-mes">Este MÃªs</button>
                <button class="filter-btn" onclick="filtrar('semana')" id="btn-semana">Esta Semana</button>
                <button class="filter-btn" onclick="filtrar('hoje')" id="btn-hoje">Hoje</button>
            </div>

            <div class="header-actions">
                <button class="icon-btn mobile-filter-toggle" onclick="toggleFilters()" id="filterToggleBtn">
                    <span class="material-symbols-outlined">filter_list</span>
                </button>

                <button class="theme-toggle" id="themeBtn" title="Alternar Tema">
                    <span class="material-symbols-outlined">light_mode</span>
                </button>
            </div>
        </div>
    </header>

    <main class="main-content">

        <div class="kpi-card blue">
            <h3>Novos Leads</h3>
            <div class="value" id="display-total">0</div>
        </div>

        <div class="kpi-card yellow clickable" onclick="openAtendimentoPanel()" title="Ver lista de atendimento">
            <h3>Em atendimento</h3>
            <div class="value" id="display-novos">0</div>
            <div class="sub-value" id="perc-novos">0.0%</div>
        </div>

        <div class="kpi-card green clickable" onclick="toggleSegmentacao()" title="Clique para ver detalhes">
            <h3>Convertidos</h3>
            <div class="value" id="display-convertidos">0</div>
            <div class="sub-value" id="perc-convertidos">0.0%</div>
        </div>

        <div class="kpi-card red clickable" onclick="toggleDescarte()" title="Ver motivos de descarte">
            <h3>Descartados</h3>
            <div class="value" id="display-descartados">0</div>
            <div class="sub-value" id="perc-descartados">0.0%</div>
        </div>

        <div class="widget-container widget-full" id="container-descarte">
            <div class="widget-header">
                <h4>Motivos de Descarte</h4>
                <button onclick="toggleDescarte()"
                    style="background:none; border:none; color:var(--text-secondary); cursor:pointer; padding:5px;">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="chart-wrapper chart-container-fix" style="height: 350px;">
                <canvas id="motivosDescarteChart"></canvas>
            </div>
        </div>

        <div class="widget-container widget-full" id="container-segmentacao">
            <div class="widget-header">
                <h4>Detalhamento dos Convertidos</h4>
                <button onclick="toggleSegmentacao()"
                    style="background:none; border:none; color:var(--text-secondary); cursor:pointer; padding:5px;">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="segmentacao-grid">
                <div class="segmentacao-item">
                    <h5>SegmentaÃ§Ã£o (Varejo vs Projeto)</h5>
                    <div class="chart-wrapper chart-container-fix">
                        <canvas id="segmentacaoChart"></canvas>
                    </div>
                </div>
                <div class="segmentacao-item">
                    <h5>Origem destes NegÃ³cios</h5>
                    <div class="chart-wrapper chart-container-fix">
                        <canvas id="fontesDealsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="widget-container widget-full">
            <div class="widget-header">
                <h4>Leads por Fonte</h4>
            </div>
            <div class="sources-grid" id="sources-container">
            </div>
        </div>

        <div class="widget-container widget-2col">
            <div class="widget-header">
                <h4>DistribuiÃ§Ã£o de Status</h4>
            </div>
            <div class="chart-wrapper">
                <canvas id="statusChart"></canvas>
            </div>
        </div>

        <div class="widget-container widget-2col">
            <div class="widget-header">
                <h4>GrÃ¡fico de Origem (Leads)</h4>
            </div>
            <div class="chart-wrapper">
                <canvas id="fontesChart"></canvas>
            </div>
        </div>

    </main>

    <div class="overlay" id="overlay" onclick="closeAtendimentoPanel()"></div>
    <div class="slide-panel" id="atendimentoPanel">
        <div class="panel-header">
            <h2>Leads em Atendimento</h2>
            <button class="close-btn" onclick="closeAtendimentoPanel()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <div class="panel-body">
            <div class="leads-table-container">
                <table class="leads-table">
                    <thead>
                        <tr>
                            <th>Nome / Contato</th>
                            <th>Origem</th>
                            <th>Local</th>
                            <th>AÃ§Ãµes</th>
                        </tr>
                    </thead>
                    <tbody id="leadsTableBody">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="panel-footer">
            <button class="load-more-btn" id="loadMoreBtn" onclick="carregarMaisLeads()">
                <div class="spinner" id="loadingSpinner"></div>
                <span id="btnText">Carregar Mais</span>
            </button>
        </div>
    </div>
</body>

</html>